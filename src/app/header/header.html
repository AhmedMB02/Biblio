<header class="main-header border-bottom">
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand brand" routerLink="/">Bibliothèque</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarContent">

        <!-- Left links -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a routerLink="/" class="nav-link" aria-current="page">Accueil</a>
          </li>
          <li class="nav-item">
            <a routerLink="/livres" routerLinkActive="active" class="nav-link">Livres</a>
          </li>
          <li class="nav-item">
            <a routerLink="/contact" routerLinkActive="active" class="nav-link">Contact</a>
          </li>
          <!-- Lien vers le dashboard utilisateur si connecté -->
          <li class="nav-item" *ngIf="currentUser && currentUser.role === 'user'">
            <a routerLink="/dashboard" routerLinkActive="active" class="nav-link">Mon Dashboard</a>
          </li>
        </ul>

        <div class="d-flex align-items-center">
          <!-- Dropdown utilisateur si connecté -->
          <div *ngIf="currentUser" class="user-dropdown me-2">
            <button class="btn btn-user-dropdown" (click)="toggleDropdown()">
              <i class="bi bi-person-circle me-2"></i>
              {{ currentUser.username }}
              <i class="bi bi-chevron-down ms-2"></i>
            </button>

            <div class="dropdown-menu-custom" [class.show]="isDropdownOpen">
              <div class="dropdown-header">
                <i class="bi bi-person-circle user-icon"></i>
                <div class="user-info">
                  <div class="user-name">{{ currentUser.username }}</div>
                  <div class="user-email">{{ currentUser.email }}</div>
                </div>
              </div>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" routerLink="/dashboard" (click)="closeDropdown()">
                <i class="bi bi-speedometer2 me-2"></i>
                Mon Profil
              </a>
              <div class="dropdown-divider"></div>
              <button class="dropdown-item logout-item" (click)="logout()">
                <i class="bi bi-box-arrow-right me-2"></i>
                Se déconnecter
              </button>
            </div>
          </div>

          <!-- Bouton de connexion si non connecté -->
          <button *ngIf="!currentUser" class="btn btn-outline-primary me-2" (click)="toggleLogin()">
            Se connecter
          </button>

        </div>

        <!-- Dark mode toggle -->
        <button class="btn btn-toggle-theme" (click)="toggleTheme()">
          <i class="bi" [class.bi-moon]="!isDarkMode" [class.bi-sun]="isDarkMode"></i>
        </button>

      </div>
    </div>
  </nav>
</header>

<!-- Modal de connexion -->
<app-login-modal *ngIf="showLoginModal" (closeModal)="closeLoginModal()" (loginSuccess)="onLoginSuccess()">
</app-login-modal>